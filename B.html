<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF 스마트 텍스트 교정기</title>
    <!-- 폰트 로드: 갈무리9 (UI용) 및 Noto Serif KR (텍스트박스용) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sun-typeface/Galmuri@latest/dist/Galmuri9.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #FFFFF0;
            --primary: #F875AA;
            --sub-pink: #FDEDED;
            --sub-green: #EDFFF0;
            --sub-blue: #AEDEFC;
            --text-main: #444;
            --border-color: #eec;
        }

        body {
            font-family: 'Galmuri9', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            background: white;
            padding: 40px;
            border-radius: 24px;
            border: 4px solid var(--primary);
            box-shadow: 8px 8px 0px rgba(0,0,0,0.05);
            width: 100%;
            max-width: 1000px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        header {
            text-align: center;
        }

        h1 {
            margin: 0 0 10px 0;
            color: var(--primary);
            font-size: 32px;
            letter-spacing: -1px;
        }

        .desc {
            color: #888;
            font-size: 14px;
            margin: 0;
        }

        .editors {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            height: 450px;
        }

        .editor-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        label {
            font-weight: bold;
            color: var(--primary);
            font-size: 15px;
            padding-left: 5px;
        }

        textarea {
            flex: 1;
            padding: 20px;
            border: 2px solid var(--border-color);
            border-radius: 16px;
            resize: none;
            /* 요청사항: 텍스트박스 내부 명조체 유지 */
            font-family: 'Noto Serif KR', serif;
            font-size: 15px;
            line-height: 1.8;
            background-color: #fff;
            color: #333;
            transition: all 0.2s;
            outline: none;
        }

        textarea:focus {
            border-color: var(--primary);
            background-color: var(--sub-pink);
        }

        textarea::placeholder {
            color: #ccc;
        }

        #outputText {
            background-color: var(--sub-blue);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 12px;
        }

        button {
            padding: 15px 35px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-family: 'Galmuri9', sans-serif;
            font-weight: bold;
            transition: all 0.2s;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 rgba(0,0,0,0.1);
            filter: brightness(1.05);
        }

        .btn-copy {
            background-color: var(--sub-green);
            color: #5a5;
            border: 2px solid #d9d; /* 연한 핑크 경계선 느낌 */
            border-color: var(--primary);
        }

        .btn-copy:hover {
            background-color: #fff;
        }

        .options {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            background: var(--sub-pink);
            padding: 15px;
            border-radius: 16px;
            font-size: 14px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
        }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }
        
        /* 스크롤바 */
        textarea::-webkit-scrollbar { width: 8px; }
        textarea::-webkit-scrollbar-track { background: transparent; }
        textarea::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }

        @media (max-width: 850px) {
            .editors { grid-template-columns: 1fr; height: auto; }
            textarea { height: 250px; }
            .container { padding: 20px; }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>PDF 스마트 텍스트 교정기</h1>
            <p class="desc">TPRG를 편하게 하자</p>
        </header>
        
        <div class="editors">
            <div class="editor-group">
                <label for="inputText">원본 텍스트 (Input)</label>
                <textarea id="inputText" placeholder="교정이 필요한 텍스트를 입력하세요..."></textarea>
            </div>
            <div class="editor-group">
                <label for="outputText">교정 결과 (Output)</label>
                <textarea id="outputText" spellcheck="true" placeholder="결과가 여기에 표시됩니다."></textarea>
            </div>
        </div>

        <div class="controls">
            <button class="btn-primary" onclick="processText()">교정하기!</button>
            <button class="btn-copy" onclick="copyToClipboard()">결과 복사</button>
        </div>

        <div class="options">
            <label class="checkbox-label">
                <input type="checkbox" id="useDict" checked>
                <span>단어장 적용</span>
            </label>
            <label class="checkbox-label">
                <input type="checkbox" id="fixJosa" checked>
                <span>조사 붙이기</span>
            </label>
            <label class="checkbox-label">
                <input type="checkbox" id="removeHyphen" checked>
                <span>하이픈 제거</span>
            </label>
        </div>
    </div>

    <script>
        // 로직 부분은 이전과 동일하게 유지됩니다.
        const userWords = [
            "무기질적인", "차가운", "서늘한", "싸늘한", "건조한", "무심한", "담담한", "냉철한",
            "희미한", "흐릿한", "창백한", "투명한", "불투명한", "선명한", "강렬한", "어두운",
            "칠흑", "정적", "고요", "침묵", "심연", "혼돈", "공허", "잔혹한", "비정한",
            "나지막이", "가만히", "멍하니", "우두커니", "물끄러미", "빤히", "조용히", "은밀히",
            "천천히", "서서히", "급격히", "맹목적인", "필연적인", "압도적인", "절망적인",
            "기계적인", "본능적인", "충동적인", "이질적인", "경이로운", "기괴한", "섬뜩한",
            "쓸쓸히", "홀로", "묵묵히", "여전히", "아득한", "아련한", "몽환적인",
            "플레이어", "마스터", "캐릭터", "시나리오", "캠페인", "세션", "핸드아웃",
            "룰북", "다이스", "주사위", "판정", "실패", "성공", "대성공", "대실패", 
            "펌블", "크리티컬", "보너스", "패널티", "난이도", "초기화", "설정",
            "탐사자", "수호자", "키퍼", "크툴루", "신화", "이성", "산치", "광기",
            "근력", "민첩", "건강", "외모", "지능", "크기", "교육", "정신력",
            "관찰력", "듣기", "심리학", "자료조사", "설득", "말재주", "위협", "매혹",
            "오컬트", "역사", "자연", "회피", "근접전", "사격", "응급처치", "의학",
            "정신분석", "기계수리", "전기수리", "열쇠공", "은밀행동", "추격",
            "오버드", "레네게이드", "더블크로스", "신드롬", "트라이브리드", "퓨어브리드", "크로스브리드",
            "침식률", "로이스", "타이타스", "백트랙", "리저렉션", "워딩", "충동", "이펙트",
            "엔젤헤일로", "발로르", "블랙독", "브람스토커", "키마이라", "엑자일", 
            "하누만", "모르페우스", "노이만", "오르쿠스", "샐러맨더", "솔라리스",
            "신체", "감각", "정신", "사회", "클라이맥스", "오프닝", "엔딩", "미들",
            "마이너", "메이저", "리액션", "오토", "셋업", "클린업", "이니셔티브",
            "그리고", "그러나", "그런데", "그러므로", "따라서", "왜냐하면", "하지만",
            "혹은", "또는", "및", "즉", "곧", "단", "만약", "비록", "아무리", "게다가",
            "사실상", "어쨌든", "어차피", "오히려", "일부러", "정말로", "제대로",
            "입니다", "습니다", "합니다", "됩니다", "칩니다", "랍니다",
            "했습", "겠습", "없습", "있습", "않습",
            "하십시오", "하세요", "이요", "나요", "군요", "네요", "던가요",
            "것입니다", "수있다", "수없다"
        ];

        function processText() {
            const input = document.getElementById('inputText').value;
            const useDict = document.getElementById('useDict').checked;
            const useSmartFix = document.getElementById('fixJosa').checked;
            const removeHyphen = document.getElementById('removeHyphen').checked;

            if (!input.trim()) return;

            const paragraphs = input.split(/\n\s*\n/);
            const processedParagraphs = paragraphs.map(para => {
                let text = para;
                text = text.replace(/([.?!])\n/g, "$1 ");
                if (removeHyphen) {
                    text = text.replace(/-\n/g, ""); 
                    text = text.replace(/- /g, "");
                }
                text = text.replace(/\n/g, " ");
                text = text.replace(/\s+/g, " ");

                if (useDict) {
                    const sortedWords = userWords.sort((a, b) => b.length - a.length);
                    sortedWords.forEach(word => {
                        const regexStr = word.split('').join('\\s*');
                        const regex = new RegExp(regexStr, 'g');
                        text = text.replace(regex, word);
                    });
                }

                if (useSmartFix) {
                    const particles1 = "은|는|이|가|을|를|의|에|로|와|과|도|만|서|고|며|께|뿐|쯤|테";
                    const regex1 = new RegExp(`([가-힣a-zA-Z0-9])\\s+(${particles1})(?=[^가-힣a-zA-Z0-9]|$)`, 'g');
                    text = text.replace(regex1, "$1$2");

                    const particles2 = "에서|에는|으로|하고|해서|이나|니다|들이|들을|들은|들의|까지|부터|조차|마저|에게|보다|라고|이다|인지|지만|도록|처럼|만큼";
                    const regex2 = new RegExp(`([가-힣a-zA-Z0-9])\\s+(${particles2})(?=[^가-힣a-zA-Z0-9]|$)`, 'g');
                    text = text.replace(regex2, "$1$2");

                    text = text.replace(/\s+([.,?!])/g, "$1");
                    text = text.replace(/\(\s+/g, "(").replace(/\s+\)/g, ")");
                }
                return text.trim();
            });

            document.getElementById('outputText').value = processedParagraphs.join('\n\n');
        }

        function copyToClipboard() {
            const outputText = document.getElementById('outputText');
            if (!outputText.value.trim()) return;
            outputText.select();
            document.execCommand('copy');
            const btn = document.querySelector('.btn-copy');
            const originalText = btn.innerText;
            btn.innerText = "복사 성공!";
            setTimeout(() => { btn.innerText = originalText; }, 1500);
        }
    </script>
</body>
</html>
